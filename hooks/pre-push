!/usr/bin/env bash

set -e

CURRENT_VERSION_TAG=`git tag --points-at | grep -E '^v[0-9]+.[0-9]+.[0-9]+$'`

if [ -z $CURRENT_VERSION_TAG ]; then
    echo "Current revision is not tagged"
    poetry dynamic-versioning 2>&1 | grep Version | sed 's|.*: |v|; s|-.*||' | xargs git tag -m "";
fi